(()=>{"use strict";var e={n:t=>{var o=t&&t.__esModule?()=>t.default:()=>t;return e.d(o,{a:o}),o},d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,o=window.wp.primitives,n=(0,t.createElement)(o.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,t.createElement)(o.Path,{d:"M16 4.2v1.5h2.5v12.5H16v1.5h4V4.2h-4zM4.2 19.8h4v-1.5H5.8V5.8h2.5V4.2h-4l-.1 15.6zm5.1-3.1l1.4.6 4-10-1.4-.6-4 10z"})),r=(window.wp.blocks,window.wp.i18n),s=window.wp.blockEditor,a=window.wp.components,l=window.wp.compose,c=function({icon:e,size:o=24,...n}){return(0,t.cloneElement)(e,{width:o,height:o,...n})},i=window.wp.data,d=window.wp.apiFetch;var m=e.n(d);const u=window.wp.shortcode;function p({setAttributes:e,attributes:o,registeredShortcodes:n}){function l(t){const n=(r=o.text,s=t.index,a=t.index+t.content.length,l=(0,u.string)(t.shortcode),r.substring(0,s)+l+r.substring(a));var r,s,a,l;e({text:n})}function c(e,t,o){t.shortcode.set(o,e),l(t)}return(0,t.createElement)(s.InspectorControls,null,(0,t.createElement)(a.Panel,null,function(e=""){const t=[];return[...e.matchAll(/\[([a-z][a-z\d_-]*)[^\]|\[]*]/g)].map((o=>{n.includes(o[1])&&t.push(function(e,t,o){const n=(0,u.next)(e,t,o),r=new RegExp(`\\[${e}([^\\]]+)?`,"gi");let s=[...n.content.matchAll(r)].map((e=>e[1]))[0];return s=s.replace(/\/$/,""),void 0!==s&&(n.shortcode.attrs=function(e){let t,o={},n=[];const r=/([\w-]+)\s*=\s*"([^"]*)"(?:\s|$)|([\w-]+)\s*=\s*'([^']*)'(?:\s|$)|([\w-]+)\s*=\s*([^\s'"]+)(?:\s|$)|"([^"]*)"(?:\s|$)|(\S+)(?:\s|$)/g;for(e=e.replace(/[\u00a0\u200b]/g," ");t=r.exec(e);)t[1]?o[t[1].toLowerCase()]=t[2]:t[3]?o[t[3].toLowerCase()]=t[4]:t[5]?o[t[5].toLowerCase()]=t[6]:t[7]?n.push(t[7]):t[8]&&n.push(t[8]);return{named:o,numeric:n}}(s)),n}(o[1],e,o.index))})),t}(o.text).map(((e,o)=>function(e,o){return(0,t.createElement)(a.PanelBody,{key:"panel_"+o,title:e.shortcode.tag.toUpperCase(),initialOpen:!1},(0,t.createElement)(t.Fragment,null,"{}"===JSON.stringify(e.shortcode.attrs.named)&&(0,t.createElement)(a.__experimentalText,{adjustLineHeightForInnerControls:!0},(0,r.__)("Shortcode has no attributes.")),Object.keys(e.shortcode.attrs.named).map(((n,r)=>(0,t.createElement)(a.TextControl,{label:n,key:o+"_"+n+"_"+r,value:e.shortcode.attrs.named[n],onChange:t=>c(t,e,n)}))),e.shortcode.attrs.numeric.map(((n,s)=>(0,t.createElement)(a.TextControl,{label:(0,r.__)("property")+" "+s,key:o+"_property_"+s,value:n,onChange:t=>c(t,e,s)}))),e.shortcode.content&&(0,t.createElement)(a.TextareaControl,{label:(0,r.__)("content"),value:e.shortcode.content,onChange:t=>function(e,t){t.shortcode.content=e,l(t)}(t,e)})))}(e,o)))))}function h({attributes:e,setAttributes:d}){const u=`blocks-shortcode-input-${(0,l.useInstanceId)(h)}`,[w,b]=(0,t.useState)(""),[g,f]=(0,t.useState)([]),_=(0,i.useSelect)((e=>["\n\t\t\thtml,body,:root {\n\t\t\t\tmargin: 0 !important;\n\t\t\t\tpadding: 0 !important;\n\t\t\t\toverflow: visible !important;\n\t\t\t\tmin-height: auto !important;\n\t\t\t}\n\t\t",...(0,s.transformStyles)(e(s.store).getSettings().styles)]),[]);return(0,t.useEffect)((()=>{m()({path:`/better-shortcode-block/shortcode?shortcode=${encodeURIComponent(e.text)}`}).then((e=>{e.success&&(f(e.registered),b(e.rendered))}))}),[e.text]),(0,t.createElement)(t.Fragment,null,(0,t.createElement)(o.View,(0,s.useBlockProps)({className:"block-library-shortcode__edit"}),(0,t.createElement)(s.BlockControls,null,(0,t.createElement)(a.ToolbarGroup,null,(0,t.createElement)(a.ToolbarButton,{className:"components-tab-button",isPressed:!e.preview,onClick:function(){d({preview:!1})}},(0,r.__)("Raw")),(0,t.createElement)(a.ToolbarButton,{className:"components-tab-button",isPressed:e.preview,onClick:function(){d({preview:!0})}},(0,r.__)("Preview")))),e.preview?(0,t.createElement)(t.Fragment,null,(0,t.createElement)(a.SandBox,{html:w,styles:_}),(0,t.createElement)("div",{style:{position:"absolute",top:"0",right:"0",bottom:"0",left:"0"}})):(0,t.createElement)("div",{className:"components-placeholder",style:{minHeight:"auto"}},(0,t.createElement)("label",{htmlFor:u,className:"components-placeholder__label"},(0,t.createElement)(c,{icon:n}),(0,r.__)("Better Shortcode")),(0,t.createElement)(s.PlainText,{className:"blocks-shortcode__textarea",id:u,value:e.text,"aria-label":(0,r.__)("Shortcode text"),placeholder:(0,r.__)("Write shortcode hereâ€¦"),onChange:e=>d({text:e})}))),(0,t.createElement)(p,{setAttributes:d,attributes:e,registeredShortcodes:g}))}function w({attributes:e}){return(0,t.createElement)(t.RawHTML,null,e.text)}const b=window.wp.autop,g={from:[{type:"shortcode",tag:"[a-z][a-z0-9_-]*",attributes:{text:{type:"string",shortcode:(e,{content:t})=>(0,b.removep)((0,b.autop)(t))}},priority:20}]},f=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":2,"name":"core/shortcode","title":"Better Shortcode","category":"widgets","description":"Insert additional custom elements with a WordPress shortcode.","textdomain":"default","attributes":{"text":{"type":"string","source":"html"},"preview":{"type":"boolean","default":false}},"supports":{"className":false,"customClassName":false,"html":false},"editorScript":"file:./build/index.js"}');wp.hooks.addFilter("blocks.registerBlockType","better-shortcode-block/replace-block",(function(e,t){return"core/shortcode"===t?{...f,icon:n,transforms:g,edit:h,save:w}:e}))})();